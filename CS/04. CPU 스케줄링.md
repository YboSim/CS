## 스케줄링의 개요

#### 스케줄링의 단계
CPU스케줄러는 관리의 범주를 나누어 스케줄링한다
- 고수준스케줄링 : 시스템내의 전체 작업수를 조절하는 것으로 어떤 작업을 시스템에 받아들일지 또는 거부할지 결정하는 단계
- 중간수준스케줄링 : 시스템 부하를 조절하기 위해 이미 활성화된 프로세스중 일부를 보류상태로 보내고 이후 이유가 생기면 다시 활성화 해주는 단계
- 저수준스케줄링 : 어떤 프로세스에 CPU를 할당할지, 어떤 프로세스를 대기상태로 보낼지 결정하는 단계
<img src="https://github.com/YboSim/Study/blob/main/Data/4-1.CPUscheduling.png" width="600" height="600" />

#### 스케줄링의 목적
- 공평성 : 모든 프로세스가 자원을 공평하게 배정하도록 함
- 효율성 : 시스템 자원이 유휴 시간 없이 사용되도록 함
- 안정성 : 우선순위를 사용하여 중요 프로세스가 먼저 작동하도록 배정함으로써 시스템 자원을 점유하거나 파괴하려는 프로세스로부터 자원을 보호하도록 함
- 확장성 : 프로세스가 증가해도 시스템이 안정적으로 작동하도록 함
- 반응시간보장 : 사용자가 시스템이 멈춘것으로 오인한는것을 방지하기위해 적절한 시간내에 프로세스의 요구에 반응하도록 함
- 무한연기방지 : 프로세스의 작업이 무한히 연기되는것을 막음

## 스케줄링 시 고려사항

#### 선점형 / 비선점형 스케줄링
- 선점형 스케줄링 : 어떤 프로세스가 CPU를 할당받아 실행중이더라도 운영체제가 CPU를 강제로 빼앗을 수 있는 스케줄링 방식
- 비선점형 스케줄링 : 어떤 프로세스가 CPU를 점유하면 다른 프로세스가 이를 빼앗을 수 없는 스케줄링 방식

|구분|선점형 스케줄링|비선점형 스케줄링|
|:---|:---|:---|
|작업 방식|실행 상태에 있는 작업을 중단시키고 새로운 작업을 실행할 수 있다|실행 상태에 있는 작업이 완료될 때까지 다른 작업이 불가능하다|
|장점|프로세스가 CPU를 독점할 수 없다|CPU 스케줄러의 작업량이 적고 문맥 교환의 오버헤드가 적다|
|단점|문맥교환의 오버헤드가 많다|기다리는 프로세스가 많아 처리율이 떨어진다|
|사용|시분할 방식 스케줄링|일괄 작업 방식 스케줄링|
|중요도|높다|낮다|

#### 프로세스 우선순위
- 프로세스의 우선순위가 없다는 것은 모든프로세스의 중요도가 같다는 것을 의미하는대, 이는 스케줄링의 목적에 공평성과 반응시간보장에 맞지 않다
- 프로세스는 커널 프로세스와 일반프로세스로 나뉘는대 커널프로세스가 일반프로세스보다 우선순위가 높다
- 각 커널프로세스간 우선순위가 존재하고 일반프로세스 역시 각 프로세스간 우선순위가 존재한다
- 우선순위가 높다는 것은 더 빨리 자주 실행된다는것을 의미한다
- 일반프로세스를 사용자가 조절 할 수 있지만 해당프로세스 뿐만 아니라 다른 프로세스의 실행속도에도 영향을 미칠 수 있다는것에 주의해야 한다

#### CPU집중 / 입출력집중 프로세스
- CPU집중 프로세스는 수학연산과 같이 CPU를 많이 사용하는 프로세스이고 입출력집중 프로세스는 저장장치에서 데이터를 복사하는 일과 같이 입출력을 많이 사용하는 프로세스이다
- CPU집중 프로세스와 입출력집중 프로세스가 같이 있을 때는 CPU집중 프로세스를 먼저 실행상태로 옮기면 다른 프로세스들이 CPU를 사용 할 수 없기 때문에 입출력집중 프로세스를 먼저 실행상태로 옮기고 입출력 요구에 의해 대기상태로 옮겨지면 다른 프로세스들이 CPU를 사용할 수 있게 된다
  (즉, 입출력집중 프로세스가 CPU집중 프로세스보다 우선순위가 높아야 효율성이 높다)
- 하기의 비교결과를 보면 이해가 쉽다
![비교결과](/Data/4-2.Compare.png)

#### 전면 / 후면 프로세스
- 전면 프로세스는 GUI를 사용하는 운영체제에서 화면에 맨앞에 놓인 프로세스로서, 예를 들어 컴퓨터 모니터의 웹브라우저와 워드가 있고 웹브라우저가 워드보다 앞에 나와있으면 웹브라우저가 전면프로세스가 되고 워드가 후면프로세스가 된다
- 전면 프로세스와 후면 프로세스가 같이 있을 때 전면 프로세스는 사용자의 요구에 즉각 반응해야 하기 때문에 후면 프로세스보다 우선순위가 높다

#### 프로세스 우선순위 비교

|우선순위 높음|우선순위 낮음|
|:---:|:---:|
|커널 프로세스|일반 프로세스|
|전면 프로세스|후면 프로세스|
|대화형 프로세스|일괄 처리 프로세스|
|입출력집중 프로세스|CPU집중 프로세스|

## 다중 큐

#### 다중큐의 목적
- 프로세스의 중요도는 저마다 다르며 중요도는 PCB에 표시된다
- 매번 모든 PCB을 검색하려면 매우 번거롭기 때문에 우선순위에 따라 단일 혹은 여러개의 큐를 만들어 관리한다

#### 준비상태의 큐
![준비상태큐](/Data/4-3.Queue.png)
- 프로세스의 준비상태에 들어올때 마다 자신의 우선순위에 해당하는 큐의 마지막(tail)에 삽입된다
- 여러개의 준비큐에 있는 프로세스 중 어떤 프로세스에 CPU를 할당할지 결정하는 것은 스케줄링 알고리즘에 따라 결정된다
- 프로세스의 우선순위 배정방식에는 **고정 우선순위 방식**과 **변동 우선순위 방식**이 있다
  1) 고정 우선순위 방식 : 운영체제가 프로세스에 우선순위를 부여하면 프로세스가 끝날때까지 바뀌지 않는 방식
  2) 변동 우선순위 방식 : 프로세스 생성 시 부여받은 우선순위가 프로세스 작업 중간에 변하는 방식
- 프로세스 상태와 준비 큐
  1) 프로세스가 생성 상태에서 준비상태로 넘어오는 과정에서 PCB이 생성되면서 우선순위가 결정되고 해당 PCB이 큐에 삽입된다
  2) 사용하는 스케줄링 알고리즘에 따라 스케줄러가 우선순위가 높은 큐의 PCB을 가져와 CPU를 할당시킨다
  3) 실행상태에서 준비상태로 돌아오는 PCB역시 상기와 같은 방식으로 반복

#### 대기상태의 큐
- 대기상태에서는 같은 입출력을 요구한 프로세스끼리 큐로 모아놓는다
- 대기큐는 준비큐와 달리 여러개의 PCB을 동시에 꺼내 준비상태로 옮긴다
- 동시에 꺼내는 인터럽트를 처리하기 위해 **인터럽트 벡터**라는 자료구조를 사용한다
- 인터럽트 벡터에는 동시에 완료된 입출력 정보와 처리방법이 담겨 있는데, 이 정보에 따라 완료된 PCB은 모두 준비상태로 이동한다
- 프로세스 상태와 대기 큐
  1) 실행상태의 PCB이 입출력 요청에 의해 대기 큐로 삽입된다
  2) 이때 같은 입출력을 요구한 프로세스의 큐에 삽입된다
  3) 입출력이 완료되면 인터럽트가 발생되고 준비상태의 큐로 삽입
