## 가상 메모리의 개요

##### 가상 메모리 시스템
- 가상 메모리는 크기가 다른 물리 메모리에서 일관되게 프로세스를 실행할 수 있는 기술이다. 즉, 물리 메모리의 크기와 상관없이 프로세스에 커다란 메모리 공간을 제공하는 것
- 물리 메모리의 크기와 프로세스가 올라갈 메모리의 위치를 신경 쓰지 않고 프로그래밍하도록 지원한다
- 가상 메모리의 최대크기는 컴퓨터 시스템이 가진 물리 메모리의 최대 크기, CPU 비트에 따라 결정된다(32bit CPU의 경우 2^32-1, 최대 약 4GB의 메모리를 갖을 수 있다)
- 실제 존재하는 물리메모리가 부족하면 하드디스크에 존재하는 스왑 영역으로 보충한다
- 가상 메모리 시스템에서 메모리 관리자는 물리 메모리와 스왑영역을 합쳐서 프로세스가 사용하는 가상 주소를 실제 메모리의 물리 주소로 변환하는데, 이를 **동적 주소 변환**이라고 한다

##### 메핑 테이블
- 메모리 관리를 수월하게 하기 위해 가상 주소와 물리 주소를 일대일로 매핑한 것을 **매핑 테이블**이라고 한다
- 메핑 테이블을 통해 가상 주소가 실제 물리 메모리에서 어느 위치에 있는지 알 수 있다
- 가변 분할 방식을 이용한 메모리 관리 기법은 **세그먼테이션**이라 하고 세그먼테이션 기법에서 사용하는 메핑 테이블을 **세그먼테이션 매핑 테이블**이라고 한다
- 고정 분할 방식을 이용한 메모리 관리 기법은 **페이징**이라 하고 페이징 기법에서 사용하는 메핑 테이블을 **페이지 매핑 테이블**이라고 한다

##### 지역성
- 기억장치에 접근하는 패턴이 메모리 전체에 고루 분포되는 것이 아니라 특정 영역에 집중되는 성질
- 공간의 지역성, 시간의 지역성, 순차적 지역성으로 나뉜다
  1) 공간의 지역성 : 현재 위치에서 가까운 데이터에 접근할 확률이 먼 거리에 있는 데이터에 접근할 확률보다 높음
  2) 시간의 지역성 : 현재를 기준으로 가장 가까운 시간에 접근한 데이터가 더 먼 시간에 접근한 데이터보다 사용될 확륙이 높음
  3) 순차적 지역성 : 일반적으로 프로그래밍은 앞에서부터 순차적으로 진행된다(순차적 지역성은 공간의 지역성의 특별한 경우로 보기도 함)
- 캐시 적중률을 높이는 것과 변환 색인 버퍼(TLB) 적중률을 높이는 것을 지역성과 연관지어 생각할 수 있다

## 페이징 기법

##### 페이징 기법의 구현
- 고정 분할 방식을 이용한 가상 메모리 관리 기법으로 물리 주소 공간을 같은 크기로 나누어 사용한다
- 가상 주소의 분할된 영역을 **페이지**라고 부르며 물리 주소의 분할된 영역을 **프레임**이라고 부른다. 각 페이지와 프레임 영역은 번호를 매겨 관리한다
- 페이지 테이블은 하나의 열로 구성되고 0번째 열부터 순서대로 페이지0 가상주소의 실제 물리 메모리의 주소인 물리 주소를 나타낸다. 물리 메모리에 올려져 있지 않는 페이지는 페이지 테이블에 물리 주소가 아닌 'invalid'로 표기한다
![페이징 기법의 구현]()

##### 페이징 기법의 주소 변환
![페이징 기법의 주소 변환]
- 상기 이미지를 예시로 들어 주소 변환 과정을 설명
  1) 가상 주소 30번이 어느 페이지에 있는지 확인한다. 30번은 페이지 3번의 0번 위치에 있다
  2) 페이지 테이블에서 가상 주소 30번이 있는 페이지가 몇번 프레임에 있는지 확인한다. 가상 주소30번은 프레임1에 존재한다
  3) 가상 메모리와 물리 메모리는 같은 크기로 나눠져 있기 때문에 가상 주소30번은 프레임1 0번 위치에 있다
- 페이징 기법에서는 가상주소를 VA = <P, D>로 표기한다. (VA - virtual address, P - page, D - 페이지의 처음 위치에서 해당 주소까지 distance)
- 페이징 기법에서는 물리주소를 PA = <F, D>로 표기한다. (PA - ahysical address, F - frame D - 프레임의 처음 위치에서 해당 주소까지 distance)
- 즉, 가상 주소 30번은 VA = <3, 0> / PA = <1, 0>로 표기할 수 있다
- P = (가상 주소 / 한 페이지의 크기)의 몫, D = (가상 주소 / 한 페이지의 크기)의 나머지로 정리 할 수 있다
